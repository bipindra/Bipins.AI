<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <RootNamespace>Bipins.AI</RootNamespace>
    <PackageId>Bipins.AI</PackageId>
    <Description>Bipins.AI - Enterprise AI platform for building intelligent applications with RAG (Retrieval-Augmented Generation), multiple LLM providers, and vector databases. Includes Core, Runtime, Ingestion, Providers (OpenAI, Anthropic, Azure OpenAI, Bedrock), and Vector integrations (Qdrant, Pinecone, Weaviate, Milvus).</Description>
    <TargetFramework>net8.0</TargetFramework>
    <IncludeBuildOutput>true</IncludeBuildOutput>
    <TargetsForTfmSpecificBuildOutput>$(TargetsForTfmSpecificBuildOutput);IncludeReferencedAssemblies</TargetsForTfmSpecificBuildOutput>
  </PropertyGroup>

  <Target Name="IncludeReferencedAssemblies" BeforeTargets="_GetPackageFiles">
    <ItemGroup>
      <!-- Include all DLLs from referenced projects that are copied locally -->
      <_ReferencedDlls Include="@(ReferenceCopyLocalPaths)" 
                       Condition="'%(ReferenceCopyLocalPaths.NuGetPackageId)' == '' AND '%(ReferenceCopyLocalPaths.Extension)' == '.dll'" />
      <_ReferencedPdbs Include="@(ReferenceCopyLocalPaths)" 
                       Condition="'%(ReferenceCopyLocalPaths.NuGetPackageId)' == '' AND '%(ReferenceCopyLocalPaths.Extension)' == '.pdb'" />
      <_ReferencedXmls Include="@(ReferenceCopyLocalPaths)" 
                       Condition="'%(ReferenceCopyLocalPaths.NuGetPackageId)' == '' AND '%(ReferenceCopyLocalPaths.Extension)' == '.xml'" />
    </ItemGroup>
    
    <ItemGroup>
      <TfmSpecificPackageFile Include="@(_ReferencedDlls)" PackagePath="lib/$(TargetFramework)/" />
      <TfmSpecificPackageFile Include="@(_ReferencedPdbs)" PackagePath="lib/$(TargetFramework)/" />
      <TfmSpecificPackageFile Include="@(_ReferencedXmls)" PackagePath="lib/$(TargetFramework)/" />
    </ItemGroup>
  </Target>

  <ItemGroup>
    <!-- Core Libraries - Prevent from becoming package dependencies, include as assemblies -->
    <ProjectReference Include="..\Bipins.AI.Core\Bipins.AI.Core.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Runtime\Bipins.AI.Runtime.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Ingestion\Bipins.AI.Ingestion.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    
    <!-- LLM Providers - Prevent from becoming package dependencies, include as assemblies -->
    <ProjectReference Include="..\Bipins.AI.Providers\Bipins.AI.Providers.OpenAI\Bipins.AI.Providers.OpenAI.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Providers\Bipins.AI.Providers.Anthropic\Bipins.AI.Providers.Anthropic.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Providers\Bipins.AI.Providers.AzureOpenAI\Bipins.AI.Providers.AzureOpenAI.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Providers\Bipins.AI.Providers.Bedrock\Bipins.AI.Providers.Bedrock.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    
    <!-- Vector Database Integrations - Prevent from becoming package dependencies, include as assemblies -->
    <ProjectReference Include="..\Bipins.AI.Vectors\Bipins.AI.Vectors.Qdrant\Bipins.AI.Vectors.Qdrant.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Vectors\Bipins.AI.Vectors.Pinecone\Bipins.AI.Vectors.Pinecone.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Vectors\Bipins.AI.Vectors.Weaviate\Bipins.AI.Vectors.Weaviate.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
    <ProjectReference Include="..\Bipins.AI.Vectors\Bipins.AI.Vectors.Milvus\Bipins.AI.Vectors.Milvus.csproj">
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </ProjectReference>
  </ItemGroup>

</Project>
